block content  
    section.mb-5
        .card.bg-light
            .card-body
                form.mb-4(method='POST', action=`/news/${news._id}/comments`)
                    textarea.form-control(rows='3' name='commentText' type='comments' placeholder='Join the discussion and leave a comment!')
                    br
                    input.btn-small.btn-primary.float-right(type='submit',value='Send')
                    br
                // Comment with nested comments
                each comment, index_comment in news.comments
                    .d-flex.mb-4
                        // Parent comment
                        .flex-shrink-0
                            img.rounded-circle(src='https://dummyimage.com/50x50/ced4da/6c757d.jpg' alt='...')
                        .ms-3
                            .fw-bold #{comment.author.username}
                            p= comment.commentText
                                a.btn.btn-danger.delete-article(href='#', data-id=comment._id) Delete
                                p.parent-comment-reply
                                    a.reply-link(type='button', data-toggle='collapse', data-target= "#response_" + index_comment, aria-expanded='false', aria-controls='response')
                                        | Reply      
                                .collapse(id= "response_" + index_comment)
                                    form.mb-4(method='POST', action=`/news/${news._id}/comments/${comment._id}/reply`)
                                        textarea.form-control(rows='3' cols='150' name='commentText' type='reply' placeholder='Join the discussion and leave a comment!')
                                        input.btn-small.btn-primary.float-right(type='submit',value='Send')
                                mixin replyToComments(comment) 
                                    each reply, index_reply in comment.replies   
                                        .d-flex.mt-4
                                            .flex-shrink-0
                                                img.rounded-circle(src='https://dummyimage.com/50x50/ced4da/6c757d.jpg' alt='...')
                                            .ms-3
                                                .fw-bold #{reply.author.username}
                                                p= reply.commentText
                                                    button.btn.btn-danger(type='button' data-toggle='modal' data-target='#deleteChildComment')
                                                        | Delete
                                                    #deleteChildComment.modal.fade(tabindex='-1' role='dialog' aria-labelledby='deleteArticleTitle' aria-hidden='true')
                                                        .modal-dialog.modal-dialog-centered(role='document')
                                                            .modal-content
                                                                .modal-header
                                                                    h5#exampleModalLongTitle.modal-title Delete Comment
                                                                    button.close(type='button' data-dismiss='modal' aria-label='Close')
                                                                    span(aria-hidden='true') Ã—
                                                                .modal-body
                                                                    | Are you sure you want to delete the comment? This action will completely remove it from the database 
                                                                .modal-footer
                                                                    button.btn.btn-secondary(type='button' data-dismiss='modal') Close
                                                                    form.d-inline(action='/news/'+ news._id +'/comments/' + reply._id + '?_method=DELETE' method='POST')
                                                                        button.btn.btn-danger(type='submit') Delete
                                                    p
                                                        a.reply-link(type='button', data-toggle='collapse', data-target="#responseReply_" + reply._id, aria-expanded='false', aria-controls='responseReply')
                                                            | Reply      
                                                    .collapse(id="responseReply_" + reply._id)
                                                        form.mb-4(method='POST', action=`/news/${news._id}/comments/${comment._id}/reply`)
                                                            textarea.form-control(rows='3' name='commentText' type='reply' placeholder='Join the discussion and leave a comment!')
                                                            input.btn-small.btn-primary.float-right.mt-2(type='submit',value='Send')
                                                    +replyToComments(reply)
                                +replyToComments(comment)